Title: 腾讯二面挂归
Date: 2014-4-3
Category: 技术

本来以为一面挂了，结果昨晚接到二面短信，今天早晨又屁颠屁颠跑到桃源假日酒店来参加二面

通知是9点40，结果等到了10点，不过比昨天一面还是强点，昨天通知的9点20结果10点半才面上，拿着号码牌上楼，话说电梯口还有专人检查号码牌，防止霸面的人插队

首先是闲扯，自我介绍完了，面试官就问了问产地是哪个省，高考多少分，高考数学多少分，高考全省排名多少之类之类，又问了你为啥读了个生物工程，我说是被调剂过来的，然后他又问当初报志愿报的都是啥，我说blabla，扯完了，就正式开始问问题

先问的是Linux

——“你Linux熟不熟？”

——“还凑合吧，平常桌面系统一直就是Linux，用了三年了”

然后面试官让我说说如何查看系统的IO、网络、CPU、内存信息，我说查看IO的话，用iostat，被面试官打断了，问“你说说iostat的命令的参数以及每一个参数对应的功能”，我平常查参数都是man或者google的啊，这玩意很久之前用过几次早都忘了，于是我说这个我不知道，而且Linux参数也没有一个比较固定的规范，每个命令参数对应的意义都不太一样，然后面试官说那你继续

然后我说网络的话用netstat，这个的参数我还记得几个（其实是昨晚上刚用），比如netstat -l是查看所有Listen的端口，-t和-u分别查看tcp和udp的状态，然后我又扯了扯netstat每一列的意义，Protocol啊Receive-Q啊Local Address啊Foreign Address还有Status啥的

面试官说你再说说怎么查看网络里的半连接，我说这个我记得netstat里面Status那一列会有相关内容表示半连接，具体内容我忘了，应该可以grep一下，netstat -l | grep XX这样，然后面试官问你怎么想到用grep的，我说把命令输入结果通过管道grep一下还是挺常用的，面试官说你举个例子，我说比如看僵尸进程一般就是ps -ef | grep -e '^[zZ]'这种，正则匹配一下，然后面试官问那找到僵尸进程以后怎么处理，我说一般查到pid以后kill掉，或者根据进程名字killall，然后面试官问你既然说到了kill，那么kill -6啥意思？我说我没用过kill -6，我只用过kill -9这个最暴力的，然后面试官接着问，你杀僵尸进程的时候怎么确保把整个相关进程树都杀干净？我说可以用pstree打印进程树来看看，面试官说嗯这个可行，那你继续往下说怎么查看CPU和内存状态

我说CPU信息一般也就是看看cat /proc/cpuinfo，内存的话cat /proc/meminfo或者free，面试官打断我问/proc有什么特点，我说/proc是个内存文件系统

然后面试官继续问怎么查看系统的load average，我说用uptime，然后面试官问uptime里面load average会输出三个值，分别代表什么？我说代表1分钟，5分钟，15分钟的运行队列里的平均进程数，然后面试官接着问什么样的进程会计入运行队列，我说没有等待IO也没有调用wait并且没有被杀死的进程是在运行队列里，面试官说嗯好

然后面试官接着问如何查看当前系统资源占用最高的几个进程，我只能想到top或者htop就说了，后来想了想忘了说再用head处理一下的，然后面试官问如果我只需要top命令输出结果中的某几列呢？我说可以用awk，然后面试官就开始问我awk，我说一般awk命令格式就是 awk -F XXX '{XXX}'，用F指定File Spliter，然后单引号+括号里面包裹着命令，比如$0是整行，$1是第一个变量blabla，然后这块就过了

然后问TCP/IP

先问三次握手四次分手，常规题，热身用的，然后就直接问TCP/IP拥塞控制算法，我说用滑动窗口来控制，如果拥塞了就减小窗口，然后他逮住这个猛问，说如果接收端发现拥塞了，滑动窗口的大小具体怎么变？我心想这不知道啊就蒙吧，就说我猜是滑动窗口减半？然后他又问了快开始和慢开始，我说我只记得慢开始是滑动窗口从1开始往上增加blabla

问完了协议又问我你写过socket没？我心想我就是个Python狗，C语言太高端了玩不起，就开始编，我说我只知道大概的socket流程，比如调用socket()然后bind到某个地址，然后send或者recv，这个我之前确实没写过，不过我读过openvswitch里面C语言的源码的socket，说到这里明显面试官觉得我是个弱菜了....

接下来问数据库和MySQL

问我说“你项目里用过MySQL没？”，我刚被前面的TCP/IP吓得够呛就不敢说用过了，就跟他说我最早用Python+Django，写数据库的时候直接硬编码SQL语句，后来被师兄说你这样一是性能可能比较差二是会有SQL注入的情况，应该用ORM，后面就开始用ORM写了，要不你试试问问？面试官就问我怎么查询慢SQL，结果我一开始听成了怎么查询MySQL，心想这答案可海了去了，确认了一遍才知道问的是“慢”SQL，我之前没搞过SQL性能优化，就开始猜，我说我记得有EXPLAIN命令可以查看，或者可以让MySQL输出LOG来查看。然后面试官继续问，如果发现一个SQL查询非常慢，怎么优化？我说这分两方面吧，一个是资源够用但是你的SQL写的烂，这种的话比如用索引啊减少子查询啊减少SELECT返回数啊把WHERE里面的OR替换成UNION啊blabla；另一种是资源不够了，这样的话横向和纵向分库分表或者分布式数据库，不过分布式的数据库的一致性问题要保证好

既然说到了分布式数据库，面试官就开始问这方面了

先问你听说过LVS没？我听成了iOS，心想这什么情况，走错片场了吧，我面的不是移动开发啊，于是确认了下，“您问的是Apple的iOS还是Cisco的IOS？” 面试官一愣，说我说的是LVS，我说啊这个我听说过，Linux Virtual Server，用来做负载均衡的似乎？然后面试官接着负载均衡往下问，让我说说负载均衡？我说负载均衡一般有外部和内部的，外部的比如最常见的CDN，根据客户请求的IP给你返回不同的DNS解析结果blabla，然后面试官问如果是内部的呢，也就是说流量已经到了数据中心，我说这个我们之前组里有师兄做过分布式的SDN控制器，最简单的方法就是Hash一下，然后将流量分布到不同服务器上，当然这个粒度就比较粗了，还应该结合服务器的实时负载，动态调整资源池blabla

然后这里面试官突然跳出来问Apache的配置，我说VirtualHost啊之类之类的，他又问如果Apache性能不好的话怎么办，我说可以换成Nginx或者Node.js试试？他又问你觉得Nginx性能比Apache好是不？我说根据我的经验来看应该是的，因为Apache是阻塞型的而Nginx是异步非阻塞的，然后面试官让我接着往下说说IO的复用模型，然后我blabla，然后继续问select/epoll/kqueue/iocp的异同以及他们分别属于哪种IO复用模型，正好我前段时间研究过这方面，就blabla说了一大堆

大概面试官觉得我之前TCP/IP那块面试表现不咋样，于是给了我个机会“我这么泛泛的问对你也不公平，你说说你有什么比较擅长的吧”，我说我写了两年Python，平常的小东西和做实验基本都是用Python，没想到一提Python全场面试就崩盘了...

面试官让我说说Python有什么比较好玩的特性，我就开始把迭代器、生成器、装饰器、lambda、map、filter往上说，面试官似乎很不耐烦“你说的这都是语言层面的东西，有没有深入一点的？”然后我就拼命想Python源码剖析那本书，说Python的小整数缓存啊多线程GIL啊还有类似的坑

然后面试官开始钓鱼，“Python性能怎么样？”我说平常使用觉得Python比C和C++慢好多，他就问为什么Python比较慢，我说blabla，然后他又问你们怎么解决Python性能问题，我说似乎有个项目叫PyPy，带有JIT支持，可以提速，或者把关键部分用C/C++改写，然后他问你C和C++会不？我一想自己基本就是个HelloWorld水平，就说哎呀基本不会，不过Java会一点，然后他问Java中的sleep和wait有什么区别，正好这个题前几天阿里的笔试题里有，就blabla，然后又问Java和C++你觉得区别在哪？我说我觉得最大的区别在于Java编译成bytecode，运行在JVM上，带有自动的垃圾回收，不需要担心内存泄露，然后又被面试官抓住了，让我说常见的垃圾回收机制，然后我说了几个标记-清扫之类的GC算法，又扯了点Obj-C的ARC神马的...

面试官说他没有问题了，问我有没有什么问题，我一看再不表现就没机会了，就开始说“我这几天一直看腾讯的Technical Report，包括微信的后台架构，比如后台分了接入层、逻辑层、存储层，然后每一层都有成熟的自动化部署和运维工具，可以快速部署应用逻辑、实现节点冗余、替换单点故障的节点，那既然已经这么成熟了，我们技术运营的主要工作是不是就少了很多？”然后他说也是也不是，很多大的业务逻辑是模块化的，但是小的业务逻辑还是需要运维人员去维护，在维护的过程中可能就会形成自动化的工具，我说原来是这样，也就是每项业务都要经历一个不断积累然后沉淀成可以复用的模块的过程，他说对，说到这里他似乎兴趣来了，问我说你对自动化运维了解多少？我就开始说比如有服务器监控工具像Nagios，结合短信报警之类，还有服务器配置管理工具比如Ruby写的Puppet（这里多扯了点因为之前用过Puppet），还有冗余、灾备等等blabla扯了几分钟

最后面试结束，我问面试官对我评价如何，面试官说“Linux使用和MySQL这块没啥问题，知识的广度也没啥问题，但是在某些方面的知识深度还有所欠缺”，心想完蛋了，临出门的时候想探探口风，就说“哎看来今天是面挂了”，结果面试官说“那不一定呢”，这句话一出口，说明是真的挂了，然后就滚回来了

上面是我能回忆起来的一些面试题，还有一堆面试题在我打车的一个小时过程中已经忘了....回过头来一总结，发现操作系统、数据库、计算机网络都问到了，还牵扯一点编译原理，还是挺全面的....9点50进去，10点35才出来，面了整整45分钟，基本上处于“我以有限的姿势水平应对面试官的BFS+DFS”的情况，所以很惨....

以上

Update:

居然二面通过了，感谢面试官